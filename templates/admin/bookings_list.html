<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Admin - Active Bookings</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
</head>
<body>
	<div class="container py-4">
		<div class="d-flex justify-content-between align-items-center mb-3">
			<h1 class="mb-0">Active Bookings</h1>
			<div>
				{% if xero_auth and xero_auth.tenant_id %}
					<span class="badge bg-success me-2">Xero Connected</span>
				{% else %}
					<a href="{{ url_for('admin.xero_connect') }}" class="btn btn-sm btn-success">Connect Xero</a>
				{% endif %}
			</div>
		</div>
		<table class="table table-striped">
			<thead>
				<tr>
					<th>ID</th>
					<th>Name</th>
					<th>Dates</th>
					<th>Payment Schedule</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				{% for b in bookings %}
				<tr>
					<td>{{ b.id }}</td>
					<td>{{ b.customer_name }}<div class="text-muted small">{{ b.email }} · {{ b.phone }}</div></td>
					<td>{{ b.start_date }} → {{ b.end_date }}</td>
					<td>
						{% if b.payment_schedule %}
							<span class="badge bg-success">Set ({{ b.payment_schedule.frequency }})</span>
						{% else %}
							<span class="badge bg-secondary">Not set</span>
						{% endif %}
					</td>
					<td>
						<a href="{{ url_for('admin.edit_booking', booking_id=b.id) }}" class="btn btn-sm btn-primary">Edit Booking</a>
						<a href="{{ url_for('admin.view_payments', booking_id=b.id) }}" class="btn btn-sm btn-outline-secondary">View Payments</a>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
		<a href="{{ url_for('main.index') }}" class="btn btn-outline-secondary btn-sm">Back to site</a>
	</div>
</body>
</html>